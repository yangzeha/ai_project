import matplotlib.pyplot as plt

# Data extracted from the user's log
epochs = list(range(1, 51))

# Loss Data
loss_tsb = [
    254.6905, 129.9516, 120.0680, 113.7910, 109.4966, 104.2925, 99.5347, 95.0306, 90.4925, 87.1225,
    83.7189, 81.3250, 78.5765, 75.8087, 74.5702, 72.7699, 70.8637, 68.9203, 67.4132, 65.5985,
    64.2632, 62.8583, 61.7177, 60.3919, 59.1229, 58.0600, 57.0613, 56.0267, 54.6996, 53.8755,
    53.0636, 51.7453, 51.1217, 50.8122, 49.8904, 49.1750, 48.3941, 47.6078, 47.0666, 46.6593,
    45.7548, 45.5842, 44.7402, 44.5479, 43.8740, 43.5719, 43.2452, 42.6874, 42.3207, 41.9410
]

loss_base = [
    184.7123, 104.0002, 98.0194, 93.5239, 90.7610, 87.1114, 83.8834, 80.6903, 77.2801, 74.7817,
    71.8657, 70.0344, 67.7393, 65.4786, 64.8108, 63.6882, 62.3216, 61.0914, 60.2040, 58.8961,
    58.1030, 57.2623, 56.4388, 55.5712, 54.5854, 53.7921, 53.0877, 52.3273, 51.3006, 50.7685,
    50.1705, 49.0373, 48.6934, 48.6154, 47.8044, 47.3091, 46.6631, 46.1298, 45.7946, 45.5255,
    44.7897, 44.7400, 44.1113, 43.9372, 43.4414, 43.2278, 43.0235, 42.5313, 42.3442, 42.0213
]

# Recall Data
recall_tsb = [
    0.0294, 0.0316, 0.0310, 0.0313, 0.0335, 0.0340, 0.0346, 0.0355, 0.0355, 0.0372,
    0.0379, 0.0381, 0.0385, 0.0388, 0.0394, 0.0401, 0.0403, 0.0403, 0.0411, 0.0404,
    0.0412, 0.0411, 0.0413, 0.0425, 0.0423, 0.0422, 0.0423, 0.0426, 0.0430, 0.0431,
    0.0431, 0.0424, 0.0427, 0.0430, 0.0427, 0.0433, 0.0430, 0.0445, 0.0446, 0.0454,
    0.0452, 0.0460, 0.0465, 0.0463, 0.0462, 0.0456, 0.0455, 0.0453, 0.0461, 0.0455
]

recall_base = [
    0.0315, 0.0313, 0.0333, 0.0326, 0.0320, 0.0334, 0.0341, 0.0352, 0.0361, 0.0384,
    0.0381, 0.0387, 0.0386, 0.0386, 0.0384, 0.0387, 0.0390, 0.0390, 0.0391, 0.0390,
    0.0397, 0.0401, 0.0403, 0.0409, 0.0404, 0.0411, 0.0415, 0.0414, 0.0418, 0.0419,
    0.0427, 0.0434, 0.0435, 0.0435, 0.0423, 0.0426, 0.0440, 0.0435, 0.0448, 0.0453,
    0.0447, 0.0457, 0.0465, 0.0458, 0.0466, 0.0458, 0.0459, 0.0452, 0.0450, 0.0460
]

# NDCG Data
ndcg_tsb = [
    0.0235, 0.0254, 0.0253, 0.0257, 0.0268, 0.0273, 0.0274, 0.0285, 0.0289, 0.0295,
    0.0298, 0.0301, 0.0303, 0.0306, 0.0311, 0.0315, 0.0317, 0.0319, 0.0324, 0.0321,
    0.0325, 0.0328, 0.0328, 0.0337, 0.0336, 0.0337, 0.0338, 0.0340, 0.0341, 0.0346,
    0.0345, 0.0343, 0.0346, 0.0349, 0.0347, 0.0351, 0.0350, 0.0359, 0.0359, 0.0361,
    0.0362, 0.0368, 0.0372, 0.0369, 0.0370, 0.0370, 0.0370, 0.0368, 0.0373, 0.0370
]

ndcg_base = [
    0.0244, 0.0249, 0.0258, 0.0260, 0.0258, 0.0267, 0.0273, 0.0279, 0.0287, 0.0297,
    0.0298, 0.0303, 0.0305, 0.0306, 0.0304, 0.0310, 0.0313, 0.0311, 0.0316, 0.0319,
    0.0322, 0.0325, 0.0329, 0.0332, 0.0334, 0.0341, 0.0348, 0.0347, 0.0350, 0.0349,
    0.0351, 0.0357, 0.0358, 0.0359, 0.0353, 0.0357, 0.0360, 0.0361, 0.0365, 0.0365,
    0.0366, 0.0373, 0.0376, 0.0372, 0.0375, 0.0376, 0.0376, 0.0374, 0.0372, 0.0376
]

plt.figure(figsize=(18, 6))

# Subplot 1: Loss
plt.subplot(1, 3, 1)
plt.plot(epochs, loss_tsb, label='TSB-CL', marker='o', markersize=4)
plt.plot(epochs, loss_base, label='Baseline', marker='x', markersize=4)
plt.xlabel('Epochs')
plt.ylabel('Training Loss')
plt.title('Training Loss Comparison')
plt.legend()
plt.grid(True)

# Subplot 2: Recall
plt.subplot(1, 3, 2)
plt.plot(epochs, recall_tsb, label='TSB-CL', marker='o', markersize=4)
plt.plot(epochs, recall_base, label='Baseline', marker='x', markersize=4)
plt.xlabel('Epochs')
plt.ylabel('Recall@20')
plt.title('Test Recall@20 Comparison')
plt.legend()
plt.grid(True)

# Subplot 3: NDCG
plt.subplot(1, 3, 3)
plt.plot(epochs, ndcg_tsb, label='TSB-CL', marker='o', markersize=4)
plt.plot(epochs, ndcg_base, label='Baseline', marker='x', markersize=4)
plt.xlabel('Epochs')
plt.ylabel('NDCG@20')
plt.title('Test NDCG@20 Comparison')
plt.legend()
plt.grid(True)

plt.tight_layout()
plt.savefig('reconstructed_results.png')
print("Plot saved to reconstructed_results.png")

import matplotlib.pyplot as plt
import numpy as np

# Data
epochs = range(1, 51)

# Model 1: Pure LightGCN (Baseline)
loss_1 = [0.5718, 0.2816, 0.2112, 0.1875, 0.1754, 0.1690, 0.1626, 0.1574, 0.1544, 0.1512, 0.1463, 0.1451, 0.1397, 0.1375, 0.1356, 0.1330, 0.1304, 0.1291, 0.1250, 0.1238, 0.1209, 0.1192, 0.1161, 0.1145, 0.1137, 0.1112, 0.1090, 0.1079, 0.1045, 0.1019, 0.1011, 0.0996, 0.0971, 0.0958, 0.0937, 0.0919, 0.0906, 0.0864, 0.0855, 0.0831, 0.0823, 0.0785, 0.0782, 0.0760, 0.0742, 0.0721, 0.0704, 0.0691, 0.0675, 0.0660]
recall_1 = [0.0434, 0.0442, 0.0439, 0.0429, 0.0456, 0.0400, 0.0380, 0.0499, 0.0420, 0.0412, 0.0432, 0.0419, 0.0463, 0.0492, 0.0403, 0.0425, 0.0631, 0.0485, 0.0568, 0.0411, 0.0502, 0.0367, 0.0418, 0.0379, 0.0489, 0.0430, 0.0536, 0.0545, 0.0478, 0.0517, 0.0520, 0.0559, 0.0716, 0.0631, 0.0792, 0.0630, 0.0568, 0.0699, 0.0804, 0.0662, 0.0854, 0.0640, 0.0690, 0.0792, 0.0786, 0.0958, 0.0850, 0.0995, 0.0784, 0.1104]
ndcg_1 = [0.0261, 0.0337, 0.0303, 0.0292, 0.0281, 0.0279, 0.0281, 0.0313, 0.0255, 0.0273, 0.0259, 0.0279, 0.0306, 0.0275, 0.0273, 0.0275, 0.0407, 0.0324, 0.0353, 0.0278, 0.0383, 0.0221, 0.0295, 0.0283, 0.0323, 0.0279, 0.0336, 0.0355, 0.0311, 0.0357, 0.0364, 0.0339, 0.0468, 0.0389, 0.0549, 0.0412, 0.0382, 0.0473, 0.0579, 0.0486, 0.0527, 0.0415, 0.0508, 0.0507, 0.0443, 0.0575, 0.0514, 0.0639, 0.0510, 0.0710]

# Model 2: Biclique GCN (tau=2)
loss_2 = [0.5313, 0.2601, 0.2053, 0.1847, 0.1733, 0.1661, 0.1625, 0.1566, 0.1536, 0.1487, 0.1451, 0.1415, 0.1391, 0.1360, 0.1337, 0.1298, 0.1277, 0.1258, 0.1226, 0.1199, 0.1169, 0.1152, 0.1109, 0.1084, 0.1072, 0.1041, 0.1015, 0.0998, 0.0966, 0.0941, 0.0921, 0.0894, 0.0870, 0.0847, 0.0815, 0.0792, 0.0780, 0.0748, 0.0739, 0.0709, 0.0678, 0.0670, 0.0642, 0.0635, 0.0595, 0.0600, 0.0570, 0.0570, 0.0540, 0.0520]
recall_2 = [0.0439, 0.0471, 0.0358, 0.0401, 0.0423, 0.0413, 0.0364, 0.0527, 0.0648, 0.0518, 0.0570, 0.0552, 0.0449, 0.0605, 0.0422, 0.0475, 0.0544, 0.0561, 0.0604, 0.0649, 0.0748, 0.0584, 0.0603, 0.0652, 0.0777, 0.0748, 0.0701, 0.0650, 0.1053, 0.0872, 0.0880, 0.1002, 0.0915, 0.1059, 0.1021, 0.1133, 0.1197, 0.1033, 0.1257, 0.1163, 0.1328, 0.1279, 0.1202, 0.1450, 0.1235, 0.1481, 0.1515, 0.1320, 0.1423, 0.1389]
ndcg_2 = [0.0272, 0.0301, 0.0261, 0.0312, 0.0297, 0.0273, 0.0278, 0.0314, 0.0400, 0.0339, 0.0379, 0.0407, 0.0347, 0.0453, 0.0335, 0.0330, 0.0383, 0.0346, 0.0407, 0.0445, 0.0519, 0.0414, 0.0416, 0.0452, 0.0503, 0.0566, 0.0517, 0.0502, 0.0702, 0.0631, 0.0668, 0.0669, 0.0603, 0.0722, 0.0745, 0.0814, 0.0796, 0.0768, 0.0898, 0.0879, 0.0949, 0.0918, 0.0872, 0.1060, 0.0882, 0.1036, 0.1038, 0.1006, 0.0997, 0.0997]

plt.figure(figsize=(18, 5))

# 1. Loss Comparison
plt.subplot(1, 3, 1)
plt.plot(epochs, loss_1, label='Baseline (LightGCN)', marker='o', markersize=3)
plt.plot(epochs, loss_2, label='Biclique GCN', marker='s', markersize=3)
plt.title('Training Loss Comparison')
plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.legend()
plt.grid(True, alpha=0.3)

# 2. Recall Comparison
plt.subplot(1, 3, 2)
plt.plot(epochs, recall_1, label='Baseline (LightGCN)', marker='o', markersize=3)
plt.plot(epochs, recall_2, label='Biclique GCN', marker='s', markersize=3)
plt.title('Test Recall@20 Comparison')
plt.xlabel('Epochs')
plt.ylabel('Recall@20')
plt.legend()
plt.grid(True, alpha=0.3)

# 3. NDCG Comparison
plt.subplot(1, 3, 3)
plt.plot(epochs, ndcg_1, label='Baseline (LightGCN)', marker='o', markersize=3)
plt.plot(epochs, ndcg_2, label='Biclique GCN', marker='s', markersize=3)
plt.title('Test NDCG@20 Comparison')
plt.xlabel('Epochs')
plt.ylabel('NDCG@20')
plt.legend()
plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('ablation_comparison_1_vs_2.png', dpi=300)
print("Comparison plot saved to ablation_comparison_1_vs_2.png")
plt.show()
